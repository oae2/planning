<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>OAE QR Generate (Advance)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body class="flex bg-gray-100 h-screen">

  <!-- Sidebar -->
  <aside class="w-64 bg-white shadow-md p-4 hidden md:block">
    <div class="text-xl font-bold mb-4 text-blue-600">OAE QR Generate</div>
    <nav class="space-y-3">
      <a href="#qr" class="nav-link block px-3 py-2 rounded hover:bg-gray-200">QR Code Generator</a>
      <a href="#shorturl" class="nav-link block px-3 py-2 rounded hover:bg-gray-200">Short URL</a>
      <a href="#pdftools" class="nav-link block px-3 py-2 rounded hover:bg-gray-200">PDF Tools</a>
      <a href="#settings" class="nav-link block px-3 py-2 rounded hover:bg-gray-200">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-6 overflow-auto">
    
    <!-- QR Code Generator Section -->
    <section id="qr" class="content-section">
      <h1 class="text-2xl font-bold text-blue-700 mb-6">‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code (‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÑ‡∏î‡πâ)</h1>
      
      <div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto">
        <label class="block mb-2 font-semibold">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏£‡∏∑‡∏≠ URL:</label>
        <input id="qrText" type="text" class="w-full p-2 border rounded mb-4" placeholder="‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡∏´‡∏£‡∏∑‡∏≠ URL">

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block mb-1 font-semibold">‡∏Ç‡∏ô‡∏≤‡∏î QR Code:</label>
            <select id="qrSize" class="w-full p-2 border rounded">
              <option value="200">‡πÄ‡∏•‡πá‡∏Å - 200x200 px</option>
              <option value="300" selected>‡∏Å‡∏•‡∏≤‡∏á - 300x300 px</option>
              <option value="400">‡πÉ‡∏´‡∏ç‡πà - 400x400 px</option>
              <option value="500">‡πÉ‡∏´‡∏ç‡πà‡∏û‡∏¥‡πÄ‡∏®‡∏© - 500x500 px</option>
            </select>
          </div>
          <div>
            <label class="block mb-1 font-semibold">‡∏™‡∏µ‡∏à‡∏∏‡∏î (Foreground):</label>
            <input type="color" id="qrColor" value="#000000" class="w-full h-[38px] border rounded">
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block mb-1 font-semibold">‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡∏≠‡∏á QR:</label>
            <select id="qrStyle" class="w-full p-2 border rounded">
              <option value="square">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (Square)</option>
              <option value="dots">‡∏à‡∏∏‡∏î (Dots)</option>
              <option value="rounded">‡∏°‡∏∏‡∏°‡∏°‡∏ô (Rounded)</option>
              <option value="classy">‡∏™‡∏ß‡∏¢‡∏´‡∏£‡∏π (Classy)</option>
              <option value="classy-rounded">Classy + Rounded</option>
              <option value="extra-rounded">Extra Rounded</option>
            </select>
          </div>
          <div>
            <label class="block mb-1 font-semibold">‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á:</label>
            <input type="color" id="qrBgColor" value="#ffffff" class="w-full h-[38px] border rounded">
          </div>
        </div>

        <!-- Logo Section -->
        <div class="mb-4 p-4 bg-gray-50 rounded-lg">
          <h3 class="font-semibold mb-2">üñºÔ∏è ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏•‡πÇ‡∏Å‡πâ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block mb-1 font-semibold">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏•‡πÇ‡∏Å‡πâ:</label>
              <input type="file" id="logoUpload" accept="image/*" class="w-full p-2 border rounded">
            </div>
            <div>
              <label class="block mb-1 font-semibold">‡∏Ç‡∏ô‡∏≤‡∏î‡πÇ‡∏•‡πÇ‡∏Å‡πâ:</label>
              <select id="logoSize" class="w-full p-2 border rounded">
                <option value="0.15">‡πÄ‡∏•‡πá‡∏Å (15%)</option>
                <option value="0.2" selected>‡∏Å‡∏•‡∏≤‡∏á (20%)</option>
                <option value="0.25">‡πÉ‡∏´‡∏ç‡πà (25%)</option>
                <option value="0.3">‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏≤‡∏Å (30%)</option>
              </select>
            </div>
          </div>
          <div class="mt-2 flex gap-2">
            <label class="inline-flex items-center">
              <input type="checkbox" id="logoBackground" class="mr-2">
              <span class="text-sm">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡∏£‡∏≠‡∏ö‡πÇ‡∏•‡πÇ‡∏Å‡πâ</span>
            </label>
          </div>
          <div class="mt-2 flex gap-2">
            <button onclick="clearLogo()" class="text-sm text-red-600 hover:text-red-800">‡∏•‡∏ö‡πÇ‡∏•‡πÇ‡∏Å‡πâ</button>
            <button onclick="testLogo()" class="text-sm text-blue-600 hover:text-blue-800">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÇ‡∏•‡πÇ‡∏Å‡πâ</button>
          </div>
          <div id="logoStatus" class="mt-2 text-sm text-gray-600"></div>
        </div>

        <button onclick="generateQR()" class="bg-blue-600 text-white px-6 py-3 rounded hover:bg-blue-700 font-medium">üé® ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code</button>

        <div id="qrContainer" class="mt-6 text-center"></div>
        <div class="text-center mt-4 hidden" id="downloadBtn">
          <div class="flex gap-2 justify-center">
            <button onclick="downloadQR('png')" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PNG</button>
            <button onclick="downloadQR('svg')" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î SVG</button>
            <button onclick="downloadQR('jpg')" class="bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î JPG</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Short URL Section -->
    <section id="shorturl" class="content-section hidden">
      <h1 class="text-2xl font-bold text-blue-700 mb-6">‡∏¢‡πà‡∏≠ URL (Short URL)</h1>
      
      <div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto">
        <label class="block mb-2 font-semibold">‡∏Å‡∏£‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏¢‡∏≤‡∏ß (Long URL):</label>
        <input id="longUrl" type="text" class="w-full p-2 border rounded mb-4" placeholder="https://example.com/very/long/link">

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block mb-1 font-semibold">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏•‡∏¥‡∏á‡∏Å‡πå:</label>
            <select id="urlType" class="w-full p-2 border rounded">
              <option value="auto">‡∏™‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (Auto)</option>
              <option value="custom">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á</option>
              <option value="readable">‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢</option>
            </select>
          </div>
          <div id="customCodeDiv" class="hidden">
            <label class="block mb-1 font-semibold">‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£/‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç):</label>
            <input id="customCode" type="text" class="w-full p-2 border rounded" placeholder="mylink" maxlength="10">
          </div>
        </div>

        <button onclick="shortenURL()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô</button>

        <div id="shortResult" class="mt-4 text-center hidden">
          <p class="mb-2 font-semibold">‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:</p>
          <div class="bg-gray-50 p-3 rounded border">
            <input id="shortLink" class="p-2 border rounded w-full text-center text-blue-700 font-semibold bg-white mb-2" readonly>
            <div class="text-sm text-gray-600 mb-2">
              ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß: <span id="linkLength" class="font-semibold"></span> ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
              <span id="linkStatus" class="ml-2 px-2 py-1 rounded text-xs"></span>
            </div>
            <div id="warningMessage" class="hidden text-sm text-orange-600 bg-orange-50 p-2 rounded mb-2">
              ‚ö†Ô∏è ‡∏ô‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≥‡∏•‡∏≠‡∏á - ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ
            </div>
            <div class="flex gap-2 justify-center">
              <button onclick="copyShortLink()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
              <button onclick="testShortLink()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
              <button onclick="generateQRFromShort()" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">‡∏™‡∏£‡πâ‡∏≤‡∏á QR</button>
            </div>
          </div>
        </div>

        <!-- Ultra Short Links Section -->
        <div class="mt-6 p-4 bg-blue-50 rounded-lg">
          <h3 class="font-semibold text-blue-800 mb-2">üöÄ ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© (Ultra Short)</h3>
          <p class="text-sm text-gray-700 mb-3">
            ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏£‡∏¥‡∏á‡∏Å‡πà‡∏≠‡∏ô ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß<br>
            <strong>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏£‡∏¥‡∏á:</strong> TinyURL, is.gd (‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á)<br>
            <strong>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≥‡∏•‡∏≠‡∏á:</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
          </p>
          <button onclick="generateUltraShort()" class="bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</button>
        </div>
      </div>
    </section>

    <!-- PDF Tools Section -->
    <section id="pdftools" class="content-section hidden">
      <h1 class="text-2xl font-bold text-blue-700 mb-6">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ PDF (PDF Tools)</h1>
      
      <!-- PDF Tool Selection -->
      <div class="bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto mb-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <button onclick="showPdfTool('merge')" class="pdf-tool-btn p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors" data-tool="merge">
            <div class="text-3xl mb-2">üìÑ</div>
            <h3 class="font-semibold">‡∏£‡∏ß‡∏° PDF</h3>
            <p class="text-sm text-gray-600">‡∏£‡∏ß‡∏°‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå PDF ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</p>
          </button>
          
          <button onclick="showPdfTool('split')" class="pdf-tool-btn p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors" data-tool="split">
            <div class="text-3xl mb-2">‚úÇÔ∏è</div>
            <h3 class="font-semibold">‡πÅ‡∏¢‡∏Å PDF</h3>
            <p class="text-sm text-gray-600">‡πÅ‡∏¢‡∏Å‡∏´‡∏ô‡πâ‡∏≤ PDF ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏¢‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏≤‡∏Å</p>
          </button>
          
          <button onclick="showPdfTool('compress')" class="pdf-tool-btn p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors" data-tool="compress">
            <div class="text-3xl mb-2">üóúÔ∏è</div>
            <h3 class="font-semibold">‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î PDF</h3>
            <p class="text-sm text-gray-600">‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå PDF</p>
          </button>
          
          <button onclick="showPdfTool('convert')" class="pdf-tool-btn p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors" data-tool="convert">
            <div class="text-3xl mb-2">üîÑ</div>
            <h3 class="font-semibold">‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå</h3>
            <p class="text-sm text-gray-600">‡πÅ‡∏õ‡∏•‡∏á PDF ‚Üî ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û, Word</p>
          </button>
        </div>
      </div>

      <!-- PDF Merge Tool -->
      <div id="pdf-merge" class="pdf-tool hidden">
        <div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto">
          <h2 class="text-xl font-bold mb-4 text-blue-700">üìÑ ‡∏£‡∏ß‡∏° PDF</h2>
          
          <div class="mb-4">
            <label class="block mb-2 font-semibold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF (‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå):</label>
            <input type="file" id="mergeFiles" multiple accept=".pdf" class="w-full p-2 border rounded">
            <p class="text-sm text-gray-500 mt-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF ‡∏´‡∏•‡∏≤‡∏¢‡πÜ ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</p>
          </div>
          
          <div id="mergeFileList" class="mb-4 hidden">
            <h3 class="font-semibold mb-2">‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</h3>
            <div id="mergeList" class="space-y-2"></div>
          </div>
          
          <button onclick="mergePDFs()" class="bg-blue-600 text-white px-6 py-3 rounded hover:bg-blue-700 font-medium">
            üìÑ ‡∏£‡∏ß‡∏° PDF
          </button>
          
          <div id="mergeProgress" class="mt-4 hidden">
            <div class="bg-gray-200 rounded-full h-3">
              <div id="mergeProgressBar" class="bg-blue-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
            <p class="text-sm text-gray-600 mt-1">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå...</p>
          </div>
        </div>
      </div>

      <!-- PDF Split Tool -->
      <div id="pdf-split" class="pdf-tool hidden">
        <div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto">
          <h2 class="text-xl font-bold mb-4 text-blue-700">‚úÇÔ∏è ‡πÅ‡∏¢‡∏Å PDF</h2>
          
          <div class="mb-4">
            <label class="block mb-2 font-semibold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF:</label>
            <input type="file" id="splitFile" accept=".pdf" class="w-full p-2 border rounded">
          </div>
          
          <div id="splitOptions" class="mb-4 hidden">
            <h3 class="font-semibold mb-2">‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å:</h3>
            <div class="space-y-3">
              <label class="inline-flex items-center">
                <input type="radio" name="splitType" value="pages" class="mr-2" checked>
                <span>‡πÅ‡∏¢‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÜ (1 ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≠ 1 ‡πÑ‡∏ü‡∏•‡πå)</span>
              </label>
              <label class="inline-flex items-center">
                <input type="radio" name="splitType" value="range" class="mr-2">
                <span>‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤</span>
              </label>
            </div>
            
            <div id="rangeInput" class="mt-3 hidden">
              <label class="block mb-1 text-sm">‡∏ä‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô 1-5, 10-15):</label>
              <input type="text" id="pageRange" class="w-full p-2 border rounded" placeholder="1-5">
            </div>
          </div>
          
          <button onclick="splitPDF()" class="bg-red-600 text-white px-6 py-3 rounded hover:bg-red-700 font-medium">
            ‚úÇÔ∏è ‡πÅ‡∏¢‡∏Å PDF
          </button>
        </div>
      </div>

      <!-- PDF Compress Tool -->
      <div id="pdf-compress" class="pdf-tool hidden">
        <div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto">
          <h2 class="text-xl font-bold mb-4 text-blue-700">üóúÔ∏è ‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î PDF</h2>
          
          <div class="mb-4">
            <label class="block mb-2 font-semibold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF:</label>
            <input type="file" id="compressFile" accept=".pdf" class="w-full p-2 border rounded">
          </div>
          
          <div class="mb-4">
            <label class="block mb-2 font-semibold">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î:</label>
            <select id="compressionLevel" class="w-full p-2 border rounded">
              <option value="low">‡∏ï‡πà‡∏≥ (‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á, ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà)</option>
              <option value="medium" selected>‡∏Å‡∏•‡∏≤‡∏á (‡∏™‡∏°‡∏î‡∏∏‡∏•)</option>
              <option value="high">‡∏™‡∏π‡∏á (‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ï‡πà‡∏≥, ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å)</option>
            </select>
          </div>
          
          <div id="originalSize" class="text-sm text-gray-600 mb-4 hidden"></div>
          
          <button onclick="compressPDF()" class="bg-green-600 text-white px-6 py-3 rounded hover:bg-green-700 font-medium">
            üóúÔ∏è ‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î PDF
          </button>
          
          <div id="compressResult" class="mt-4 hidden">
            <div class="bg-green-50 p-3 rounded border">
              <h3 class="font-semibold text-green-800">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î:</h3>
              <div id="compressionStats" class="text-sm text-green-700"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- PDF Convert Tool -->
      <div id="pdf-convert" class="pdf-tool hidden">
        <div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto">
          <h2 class="text-xl font-bold mb-4 text-blue-700">üîÑ ‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå</h2>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <div>
              <label class="block mb-2 font-semibold">‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏≤‡∏Å:</label>
              <select id="convertFrom" class="w-full p-2 border rounded">
                <option value="pdf">PDF</option>
                <option value="image">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (JPG, PNG)</option>
                <option value="word">Word (.docx)</option>
              </select>
            </div>
            <div>
              <label class="block mb-2 font-semibold">‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô:</label>
              <select id="convertTo" class="w-full p-2 border rounded">
                <option value="image">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (PNG)</option>
                <option value="pdf">PDF</option>
                <option value="word">Word (.docx)</option>
              </select>
            </div>
          </div>
          
          <div class="mb-4">
            <label class="block mb-2 font-semibold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå:</label>
            <input type="file" id="convertFile" class="w-full p-2 border rounded">
          </div>
          
          <div id="convertOptions" class="mb-4 hidden">
            <label class="block mb-2 font-semibold">‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û:</label>
            <select id="imageQuality" class="w-full p-2 border rounded">
              <option value="low">‡∏ï‡πà‡∏≥ (72 DPI)</option>
              <option value="medium" selected>‡∏Å‡∏•‡∏≤‡∏á (150 DPI)</option>
              <option value="high">‡∏™‡∏π‡∏á (300 DPI)</option>
            </select>
          </div>
          
          <button onclick="convertFile()" class="bg-purple-600 text-white px-6 py-3 rounded hover:bg-purple-700 font-medium">
            üîÑ ‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå
          </button>
        </div>
      </div>
    </section>

    <!-- Settings Section -->
    <section id="settings" class="content-section hidden">
      <h1 class="text-2xl font-bold text-blue-700 mb-6">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h1>
      
      <div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto">
        <div class="space-y-6">
          <div>
            <h3 class="text-lg font-semibold mb-3">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h3>
            <div class="space-y-3">
              <label class="inline-flex items-center">
                <input type="checkbox" id="autosave" class="mr-2">
                <span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</span>
              </label>
              <label class="inline-flex items-center">
                <input type="checkbox" id="darkmode" class="mr-2">
                <span>‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô</span>
              </label>
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-3">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ QR Code</h3>
            <div class="space-y-3">
              <div>
                <label class="block mb-1 font-semibold">‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:</label>
                <select class="w-full p-2 border rounded">
                  <option value="300">300x300 px</option>
                  <option value="400">400x400 px</option>
                  <option value="500">500x500 px</option>
                </select>
              </div>
              <div>
                <label class="block mb-1 font-semibold">‡∏™‡∏µ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:</label>
                <input type="color" value="#000000" class="w-full h-[38px] border rounded">
              </div>
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-3">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö</h3>
            <p class="text-gray-600">OAE QR Generate v1.0</p>
            <p class="text-gray-600">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ QR Code, Short URL ‡πÅ‡∏•‡∏∞ PDF</p>
          </div>
          
          <button class="bg-blue-600 text-white px-6 py-3 rounded hover:bg-blue-700 font-medium">
            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
          </button>
        </div>
      </div>
    </section>

  </main>

  <script>
    let qr = null;
    let logoImage = null;

    // Navigation Functions - Fixed
    function showSection(sectionId) {
      console.log('Switching to section:', sectionId);
      
      // Hide all sections
      document.querySelectorAll(".content-section").forEach(section => {
        section.classList.add("hidden");
      });
      
      // Show target section
      const targetSection = document.getElementById(sectionId);
      if (targetSection) {
        targetSection.classList.remove("hidden");
        console.log('Section shown:', sectionId);
      } else {
        console.error('Section not found:', sectionId);
      }
      
      // Update navigation active state
      document.querySelectorAll(".nav-link").forEach(link => {
        link.classList.remove("bg-blue-100", "text-blue-700", "font-medium");
        link.classList.add("hover:bg-gray-200");
      });
      
      const activeLink = document.querySelector(`a[href="#${sectionId}"]`);
      if (activeLink) {
        activeLink.classList.add("bg-blue-100", "text-blue-700", "font-medium");
        activeLink.classList.remove("hover:bg-gray-200");
        console.log('Navigation updated for:', sectionId);
      }
    }

    // QR Code Functions
    async function generateQR() {
      const text = document.getElementById("qrText").value.trim();
      const size = parseInt(document.getElementById("qrSize").value);
      const color = document.getElementById("qrColor").value;
      const bgColor = document.getElementById("qrBgColor").value;
      const style = document.getElementById("qrStyle").value;
      const logoSize = parseFloat(document.getElementById("logoSize").value);
      const logoBackground = document.getElementById("logoBackground").checked;

      if (!text) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô");

      // Clear previous QR
      if (qr) {
        document.getElementById("qrContainer").innerHTML = "";
      }

      // Basic QR Code configuration
      const qrConfig = {
        width: size,
        height: size,
        data: text,
        dotsOptions: {
          color: color,
          type: style
        },
        backgroundOptions: {
          color: bgColor
        },
        cornersSquareOptions: {
          color: color,
          type: style === "dots" ? "square" : style
        },
        cornersDotOptions: {
          color: color,
          type: style === "dots" ? "square" : style
        }
      };

      // Add logo configuration if logo exists
      if (logoImage) {
        qrConfig.image = logoImage;
        qrConfig.imageOptions = {
          crossOrigin: "anonymous",
          margin: 10,
          imageSize: logoSize,
          hideBackgroundDots: logoBackground,
          saveAsBlob: true
        };
        
        console.log("Logo added to QR config:", {
          imageSize: logoSize,
          hideBackgroundDots: logoBackground,
          logoImage: logoImage ? "Present" : "Missing"
        });
      } else {
        console.log("No logo to add");
      }

      try {
        qr = new QRCodeStyling(qrConfig);
        
        // Wait a bit for the library to process
        await new Promise(resolve => setTimeout(resolve, 100));
        
        qr.append(document.getElementById("qrContainer"));
        document.getElementById("downloadBtn").classList.remove("hidden");
        
        console.log("QR Code generated successfully");
      } catch (error) {
        console.error("Error generating QR Code:", error);
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code");
      }
    }

    function downloadQR(format = 'png') {
      if (qr) {
        const filename = `qr-code-${Date.now()}`;
        qr.download({ 
          name: filename, 
          extension: format 
        });
      }
    }

    function clearLogo() {
      logoImage = null;
      document.getElementById("logoUpload").value = "";
      
      console.log("Logo cleared");
      
      // Regenerate QR without logo if QR exists
      if (document.getElementById("qrText").value.trim()) {
        generateQR();
      }
    }

    function testLogo() {
      if (logoImage) {
        console.log("Logo image data:", logoImage.substring(0, 50) + "...");
        
        // Create a test image to verify logo loads
        const img = new Image();
        img.onload = () => {
          console.log("Logo image loads successfully:", img.width, "x", img.height);
        };
        img.onerror = () => {
          console.error("Logo image failed to load");
        };
        img.src = logoImage;
      } else {
        console.log("No logo image available");
      }
    }

    // Short URL Functions
    async function shortenURL() {
      const longUrl = document.getElementById("longUrl").value.trim();
      const urlType = document.getElementById("urlType").value;
      const customCode = document.getElementById("customCode").value.trim();
      const resultDiv = document.getElementById("shortResult");
      const shortLinkInput = document.getElementById("shortLink");
      const lengthSpan = document.getElementById("linkLength");
      const button = document.querySelector('button[onclick="shortenURL()"]');

      if (!longUrl) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Å‡πà‡∏≠‡∏ô");
        return;
      }

      if (!longUrl.startsWith("http://") && !longUrl.startsWith("https://")) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô https://example.com");
        return;
      }

      // Show loading state
      button.disabled = true;
      button.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á...";

      let shortLink = "";

      try {
        if (urlType === "custom" && customCode) {
          shortLink = await createCustomShortURL(longUrl, customCode);
        } else if (urlType === "readable") {
          shortLink = await createReadableShortURL(longUrl);
        } else {
          shortLink = await createAutoShortURL(longUrl);
        }

        shortLinkInput.value = shortLink;
        lengthSpan.textContent = shortLink.length;
        resultDiv.classList.remove("hidden");

      } catch (error) {
        console.error("Error:", error);
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error.message);
      }

      // Reset button state
      button.disabled = false;
      button.textContent = "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô";
    }

    async function createAutoShortURL(longUrl) {
      // Try real ultra-short services first
      const realAPIs = [
        {
          name: "TinyURL",
          url: `https://tinyurl.com/api-create.php?url=${encodeURIComponent(longUrl)}`,
          method: "GET",
          parser: (response) => response.text(),
          isReal: true
        },
        {
          name: "is.gd", 
          url: `https://is.gd/create.php?format=simple&url=${encodeURIComponent(longUrl)}`,
          method: "GET",
          parser: (response) => response.text(),
          isReal: true
        }
      ];

      // Try real APIs first
      for (const api of realAPIs) {
        try {
          console.log(`Trying ${api.name}...`);
          
          const response = await fetch(api.url, {
            method: api.method,
            mode: 'cors'
          });

          if (!response.ok) continue;

          const shortLink = await api.parser(response);
          
          if (shortLink && shortLink.startsWith('http')) {
            updateLinkStatus(true);
            return shortLink;
          }
        } catch (error) {
          console.error(`${api.name} failed:`, error);
          continue;
        }
      }

      // If all real APIs fail, show mock with warning
      updateLinkStatus(false);
      return generateUltraShortFallback(longUrl);
    }

    async function createCustomShortURL(longUrl, customCode) {
      // Try TinyURL with custom alias first
      try {
        const response = await fetch(`https://tinyurl.com/api-create.php?url=${encodeURIComponent(longUrl)}&alias=${customCode}`, {
          mode: 'cors'
        });
        const result = await response.text();
        if (result.startsWith('http') && !result.includes('Error')) {
          updateLinkStatus(true);
          return result;
        }
      } catch (error) {
        console.error("Custom TinyURL failed:", error);
      }
      
      // Fallback to mock
      updateLinkStatus(false);
      return `https://s.ly/${customCode}`;
    }

    async function createReadableShortURL(longUrl) {
      // Try TinyURL first
      try {
        const response = await fetch(`https://tinyurl.com/api-create.php?url=${encodeURIComponent(longUrl)}`, {
          mode: 'cors'
        });
        const result = await response.text();
        if (result.startsWith('http')) {
          updateLinkStatus(true);
          return result;
        }
      } catch (error) {
        // Fallback to mock readable URL
      }

      // Extract readable part from URL for mock
      const url = new URL(longUrl);
      const pathParts = url.pathname.split('/').filter(p => p.length > 0);
      const readable = pathParts[pathParts.length - 1] || url.hostname.split('.')[0];
      const cleanReadable = readable.replace(/[^a-zA-Z0-9]/g, '').substring(0, 8);
      
      updateLinkStatus(false);
      return `https://go.to/${cleanReadable}`;
    }

    function updateLinkStatus(isReal) {
      const statusSpan = document.getElementById("linkStatus");
      const warningDiv = document.getElementById("warningMessage");
      
      if (isReal) {
        statusSpan.textContent = "‚úÖ ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á";
        statusSpan.className = "ml-2 px-2 py-1 rounded text-xs bg-green-100 text-green-800";
        warningDiv.classList.add("hidden");
      } else {
        statusSpan.textContent = "‚ö†Ô∏è ‡∏à‡∏≥‡∏•‡∏≠‡∏á";
        statusSpan.className = "ml-2 px-2 py-1 rounded text-xs bg-orange-100 text-orange-800";
        warningDiv.classList.remove("hidden");
      }
    }

    function generateUltraShort() {
      const longUrl = document.getElementById("longUrl").value.trim();
      
      if (!longUrl) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Å‡πà‡∏≠‡∏ô");
        return;
      }

      if (!longUrl.startsWith("http://") && !longUrl.startsWith("https://")) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô https://example.com");
        return;
      }

      // Show it's a mock for demonstration
      const ultraShort = generateUltraShortFallback(longUrl);
      document.getElementById("shortLink").value = ultraShort;
      document.getElementById("linkLength").textContent = ultraShort.length;
      document.getElementById("shortResult").classList.remove("hidden");
      
      // Always show as mock for ultra short demo
      updateLinkStatus(false);
    }

    function generateUltraShortFallback(longUrl) {
      // Create ultra-short URLs for demo purposes (showing potential length)
      const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      const hash = btoa(longUrl).replace(/[^a-zA-Z0-9]/g, '');
      let short = '';
      
      for (let i = 0; i < 4; i++) {
        short += chars[hash.charCodeAt(i) % chars.length];
      }
      
      return `s.ly/${short}`; // Demo: 8 characters total
    }

    function copyShortLink() {
      const shortLinkInput = document.getElementById("shortLink");
      shortLinkInput.select();
      shortLinkInput.setSelectionRange(0, 99999);
      
      try {
        document.execCommand("copy");
        alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß!");
      } catch (err) {
        // Fallback for modern browsers
        navigator.clipboard.writeText(shortLinkInput.value).then(() => {
          alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß!");
        }).catch(() => {
          alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á");
        });
      }
    }

    function testShortLink() {
      const shortLink = document.getElementById("shortLink").value;
      const statusSpan = document.getElementById("linkStatus");
      
      if (shortLink) {
        // Check if it's a real link
        if (statusSpan.textContent.includes("‚úÖ")) {
          window.open(shortLink, '_blank');
        } else {
          alert("‚ö†Ô∏è ‡∏ô‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≥‡∏•‡∏≠‡∏á ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á\n\n‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° '‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô' ‡πÅ‡∏ö‡∏ö '‡∏™‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (Auto)' ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏£‡∏¥‡∏á");
        }
      }
    }

    function generateQRFromShort() {
      const shortLink = document.getElementById("shortLink").value;
      if (shortLink) {
        document.getElementById("qrText").value = shortLink;
        showSection("qr");
        generateQR();
      }
    }

    // PDF Tools Functions
    function showPdfTool(toolType) {
      console.log('showPdfTool called with:', toolType);
      
      // Hide all PDF tools
      document.querySelectorAll('.pdf-tool').forEach(tool => {
        tool.classList.add('hidden');
      });
      
      // Remove active state from all buttons
      document.querySelectorAll('.pdf-tool-btn').forEach(btn => {
        btn.classList.remove('border-blue-500', 'bg-blue-50');
        btn.classList.add('border-gray-200');
      });
      
      // Show selected tool
      const targetTool = document.getElementById(`pdf-${toolType}`);
      if (targetTool) {
        targetTool.classList.remove('hidden');
        console.log('Showing tool:', toolType);
      } else {
        console.error('Tool not found:', `pdf-${toolType}`);
      }
      
      // Add active state to clicked button
      const clickedBtn = document.querySelector(`[data-tool="${toolType}"]`);
      if (clickedBtn) {
        clickedBtn.classList.add('border-blue-500', 'bg-blue-50');
        clickedBtn.classList.remove('border-gray-200');
      }
    }

    function handleMergeFiles(e) {
      console.log('handleMergeFiles called');
      const files = Array.from(e.target.files);
      const fileList = document.getElementById('mergeFileList');
      const list = document.getElementById('mergeList');
      
      if (files.length > 0) {
        fileList.classList.remove('hidden');
        list.innerHTML = '';
        
        files.forEach((file, index) => {
          const item = document.createElement('div');
          item.className = 'flex items-center justify-between p-2 bg-gray-50 rounded';
          item.innerHTML = `
            <span class="text-sm">${index + 1}. ${file.name}</span>
            <span class="text-xs text-gray-500">${(file.size / 1024 / 1024).toFixed(2)} MB</span>
          `;
          list.appendChild(item);
        });
      } else {
        fileList.classList.add('hidden');
      }
    }

    function handleSplitFile(e) {
      console.log('handleSplitFile called');
      const file = e.target.files[0];
      const options = document.getElementById('splitOptions');
      
      if (file) {
        options.classList.remove('hidden');
      } else {
        options.classList.add('hidden');
      }
    }

    function handleCompressFile(e) {
      console.log('handleCompressFile called');
      const file = e.target.files[0];
      const sizeDiv = document.getElementById('originalSize');
      
      if (file) {
        const sizeMB = (file.size / 1024 / 1024).toFixed(2);
        sizeDiv.textContent = `‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö: ${sizeMB} MB`;
        sizeDiv.classList.remove('hidden');
      } else {
        sizeDiv.classList.add('hidden');
      }
    }

    function handleConvertFile(e) {
      console.log('handleConvertFile called');
      const file = e.target.files[0];
      updateConvertOptions();
    }

    function updateConvertOptions() {
      const convertTo = document.getElementById('convertTo').value;
      const options = document.getElementById('convertOptions');
      
      if (convertTo === 'image') {
        options.classList.remove('hidden');
      } else {
        options.classList.add('hidden');
      }
    }

    async function mergePDFs() {
      console.log('mergePDFs called');
      const files = document.getElementById('mergeFiles').files;
      const progress = document.getElementById('mergeProgress');
      const progressBar = document.getElementById('mergeProgressBar');
      
      if (files.length < 2) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡πÑ‡∏ü‡∏•‡πå');
        return;
      }
      
      if (typeof PDFLib === 'undefined') {
        alert('‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ PDF ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
        return;
      }
      
      try {
        progress.classList.remove('hidden');
        progressBar.style.width = '10%';
        
        const mergedPdf = await PDFLib.PDFDocument.create();
        
        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          const arrayBuffer = await file.arrayBuffer();
          const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
          const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
          
          pages.forEach(page => mergedPdf.addPage(page));
          
          progressBar.style.width = `${((i + 1) / files.length) * 80 + 10}%`;
        }
        
        progressBar.style.width = '95%';
        
        const pdfBytes = await mergedPdf.save();
        const blob = new Blob([pdfBytes], { type: 'application/pdf' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = `merged-pdf-${Date.now()}.pdf`;
        a.click();
        
        progressBar.style.width = '100%';
        setTimeout(() => {
          progress.classList.add('hidden');
          progressBar.style.width = '0%';
          alert('‡∏£‡∏ß‡∏° PDF ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!');
        }, 1000);
        
      } catch (error) {
        console.error('Error merging PDFs:', error);
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏° PDF: ' + error.message);
        progress.classList.add('hidden');
      }
    }

    async function splitPDF() {
      console.log('splitPDF called');
      const file = document.getElementById('splitFile').files[0];
      const splitType = document.querySelector('input[name="splitType"]:checked').value;
      const pageRange = document.getElementById('pageRange').value;
      
      if (!file) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF');
        return;
      }
      
      if (typeof PDFLib === 'undefined') {
        alert('‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ PDF ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
        return;
      }
      
      try {
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
        const totalPages = pdf.getPageCount();
        
        console.log('Total pages:', totalPages);
        
        if (splitType === 'pages') {
          // Split into individual pages
          for (let i = 0; i < totalPages; i++) {
            const newPdf = await PDFLib.PDFDocument.create();
            const [page] = await newPdf.copyPages(pdf, [i]);
            newPdf.addPage(page);
            
            const pdfBytes = await newPdf.save();
            const blob = new Blob([pdfBytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `page-${i + 1}.pdf`;
            a.click();
            
            // Small delay between downloads
            await new Promise(resolve => setTimeout(resolve, 100));
          }
        } else if (splitType === 'range' && pageRange) {
          // Split by range
          const ranges = pageRange.split(',').map(r => r.trim());
          
          for (const range of ranges) {
            const [start, end] = range.split('-').map(n => parseInt(n.trim()) - 1);
            
            if (start >= 0 && end < totalPages && start <= end) {
              const newPdf = await PDFLib.PDFDocument.create();
              const pages = await newPdf.copyPages(pdf, Array.from({length: end - start + 1}, (_, i) => start + i));
              pages.forEach(page => newPdf.addPage(page));
              
              const pdfBytes = await newPdf.save();
              const blob = new Blob([pdfBytes], { type: 'application/pdf' });
              const url = URL.createObjectURL(blob);
              
              const a = document.createElement('a');
              a.href = url;
              a.download = `pages-${start + 1}-to-${end + 1}.pdf`;
              a.click();
              
              await new Promise(resolve => setTimeout(resolve, 100));
            }
          }
        }
        
        alert('‡πÅ‡∏¢‡∏Å PDF ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!');
        
      } catch (error) {
        console.error('Error splitting PDF:', error);
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å PDF: ' + error.message);
      }
    }

    async function compressPDF() {
      console.log('compressPDF called');
      const file = document.getElementById('compressFile').files[0];
      const level = document.getElementById('compressionLevel').value;
      
      if (!file) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF');
        return;
      }
      
      if (typeof PDFLib === 'undefined') {
        alert('‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ PDF ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
        return;
      }
      
      try {
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
        
        // Simple compression by re-saving with different options
        const pdfBytes = await pdf.save({
          useObjectStreams: level !== 'low',
          addDefaultPage: false,
          objectsPerTick: level === 'high' ? 50 : level === 'medium' ? 30 : 20
        });
        
        const originalSize = file.size;
        const compressedSize = pdfBytes.length;
        const compressionRatio = ((originalSize - compressedSize) / originalSize * 100).toFixed(1);
        
        const blob = new Blob([pdfBytes], { type: 'application/pdf' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = `compressed-${file.name}`;
        a.click();
        
        const resultDiv = document.getElementById('compressResult');
        const statsDiv = document.getElementById('compressionStats');
        statsDiv.innerHTML = `
          <p>‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏î‡∏¥‡∏°: ${(originalSize / 1024 / 1024).toFixed(2)} MB</p>
          <p>‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î: ${(compressedSize / 1024 / 1024).toFixed(2)} MB</p>
          <p>‡∏•‡∏î‡∏•‡∏á: ${compressionRatio >= 0 ? compressionRatio : 0}%</p>
        `;
        resultDiv.classList.remove('hidden');
        
        alert('‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î PDF ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!');
        
      } catch (error) {
        console.error('Error compressing PDF:', error);
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î PDF: ' + error.message);
      }
    }

    async function convertFile() {
      console.log('convertFile called');
      const file = document.getElementById('convertFile').files[0];
      const convertFrom = document.getElementById('convertFrom').value;
      const convertTo = document.getElementById('convertTo').value;
      
      if (!file) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå');
        return;
      }
      
      try {
        if (convertFrom === 'image' && convertTo === 'pdf') {
          await convertImageToPDF(file);
        } else if (convertFrom === 'pdf' && convertTo === 'image') {
          await convertPDFToImage(file);
        } else {
          alert('‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏≠‡∏∑‡πà‡∏ô');
        }
      } catch (error) {
        console.error('Error converting file:', error);
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå: ' + error.message);
      }
    }

    async function convertImageToPDF(imageFile) {
      console.log('convertImageToPDF called');
      
      if (typeof PDFLib === 'undefined') {
        alert('‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ PDF ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
        return;
      }
      
      const pdf = await PDFLib.PDFDocument.create();
      const imageBytes = await imageFile.arrayBuffer();
      
      let image;
      if (imageFile.type === 'image/jpeg' || imageFile.type === 'image/jpg') {
        image = await pdf.embedJpg(imageBytes);
      } else if (imageFile.type === 'image/png') {
        image = await pdf.embedPng(imageBytes);
      } else {
        throw new Error('‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå JPG ‡πÅ‡∏•‡∏∞ PNG ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô');
      }
      
      const page = pdf.addPage([image.width, image.height]);
      page.drawImage(image, {
        x: 0,
        y: 0,
        width: image.width,
        height: image.height,
      });
      
      const pdfBytes = await pdf.save();
      const blob = new Blob([pdfBytes], { type: 'application/pdf' });
      const url = URL.createObjectURL(blob);
      
      const a = document.createElement('a');
      a.href = url;
      a.download = `converted-${imageFile.name.split('.')[0]}.pdf`;
      a.click();
      
      alert('‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏õ‡πá‡∏ô PDF ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!');
    }

    async function convertPDFToImage(pdfFile) {
      alert('‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á PDF ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°\n‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏ä‡πà‡∏ô SmallPDF ‡∏´‡∏£‡∏∑‡∏≠ ILovePDF');
    }

    // Event Listeners - Fixed
    document.addEventListener("DOMContentLoaded", () => {
      console.log('DOM loaded, setting up event listeners');

      // Handle navigation clicks
      document.querySelectorAll(".nav-link").forEach(link => {
        link.addEventListener("click", (e) => {
          e.preventDefault();
          const href = link.getAttribute("href");
          console.log('Navigation clicked:', href);
          if (href.startsWith("#")) {
            const sectionId = href.substring(1);
            showSection(sectionId);
            window.location.hash = href;
          }
        });
      });

      // URL Type change handler
      const urlTypeSelect = document.getElementById("urlType");
      if (urlTypeSelect) {
        urlTypeSelect.addEventListener("change", (e) => {
          const customDiv = document.getElementById("customCodeDiv");
          if (e.target.value === "custom") {
            customDiv.classList.remove("hidden");
          } else {
            customDiv.classList.add("hidden");
          }
        });
      }

      // Logo upload handler
      const logoUploadInput = document.getElementById("logoUpload");
      if (logoUploadInput) {
        logoUploadInput.addEventListener("change", async (e) => {
          const file = e.target.files[0];
          if (file) {
            console.log("Logo file selected:", file.name, file.type, file.size);
            
            // Validate file type
            if (!file.type.startsWith('image/')) {
              alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
              return;
            }
            
            // Validate file size (max 5MB)
            if (file.size > 5 * 1024 * 1024) {
              alert("‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB");
              return;
            }
            
            try {
              const reader = new FileReader();
              reader.onload = async (event) => {
                logoImage = event.target.result;
                console.log("Logo loaded successfully, size:", logoImage.length);
                
                // Test if image loads properly
                const img = new Image();
                img.onload = () => {
                  console.log("Logo image validated:", img.width, "x", img.height);
                  
                  // Auto-regenerate QR if text exists
                  if (document.getElementById("qrText").value.trim()) {
                    console.log("Auto-regenerating QR with logo");
                    generateQR();
                  } else {
                    console.log("No text yet, logo ready for next generation");
                  }
                };
                img.onerror = () => {
                  console.error("Logo image failed to validate");
                  alert("‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà");
                  logoImage = null;
                };
                img.src = logoImage;
              };
              
              reader.onerror = () => {
                console.error("Failed to read logo file");
                alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ");
              };
              
              reader.readAsDataURL(file);
            } catch (error) {
              console.error("Error processing logo:", error);
              alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û");
            }
          }
        });
      }

      // Handle split type change
      document.addEventListener('change', (e) => {
        if (e.target.name === 'splitType') {
          const rangeInput = document.getElementById('rangeInput');
          if (e.target.value === 'range') {
            rangeInput.classList.remove('hidden');
          } else {
            rangeInput.classList.add('hidden');
          }
        }
      });

      // Handle convert from/to change
      const convertFromSelect = document.getElementById('convertFrom');
      const convertToSelect = document.getElementById('convertTo');
      
      if (convertFromSelect && convertToSelect) {
        convertFromSelect.addEventListener('change', updateConvertOptions);
        convertToSelect.addEventListener('change', updateConvertOptions);
      }

      // Handle file uploads for PDF tools
      const mergeFilesInput = document.getElementById('mergeFiles');
      const splitFileInput = document.getElementById('splitFile'); 
      const compressFileInput = document.getElementById('compressFile');
      const convertFileInput = document.getElementById('convertFile');

      if (mergeFilesInput) {
        mergeFilesInput.addEventListener('change', handleMergeFiles);
      }
      if (splitFileInput) {
        splitFileInput.addEventListener('change', handleSplitFile);
      }
      if (compressFileInput) {
        compressFileInput.addEventListener('change', handleCompressFile);
      }
      if (convertFileInput) {
        convertFileInput.addEventListener('change', handleConvertFile);
      }

      // Test PDF library loading
      setTimeout(() => {
        if (typeof PDFLib !== 'undefined') {
          console.log('PDF-lib loaded successfully');
        } else {
          console.error('PDF-lib failed to load');
        }
      }, 2000);

      // Handle initial hash
      const hash = window.location.hash;
      if (hash) {
        const sectionId = hash.substring(1);
        showSection(sectionId);
      } else {
        showSection("qr"); // Default to QR section
      }

      console.log('All event listeners set up successfully');
    });

    // Handle hash changes
    window.addEventListener("hashchange", () => {
      const hash = window.location.hash;
      if (hash) {
        const sectionId = hash.substring(1);
        showSection(sectionId);
      }
    });

    // Enter key support for inputs
    document.addEventListener("DOMContentLoaded", () => {
      const qrTextInput = document.getElementById("qrText");
      const longUrlInput = document.getElementById("longUrl");
      
      if (qrTextInput) {
        qrTextInput.addEventListener("keypress", (e) => {
          if (e.key === "Enter") generateQR();
        });
      }

      if (longUrlInput) {
        longUrlInput.addEventListener("keypress", (e) => {
          if (e.key === "Enter") shortenURL();
        });
      }
    });

    // Mobile menu toggle (for future enhancement)
    function toggleMobileMenu() {
      const sidebar = document.querySelector('aside');
      sidebar.classList.toggle('hidden');
    }

    console.log('Script loaded successfully');
  </script>

</body>
</html>
