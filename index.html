<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>OAE QR Genrate (Advance)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
</head>
<body class="flex bg-gray-100 h-screen">

  <!-- Sidebar -->
  <aside class="w-64 bg-white shadow-md p-4 hidden md:block">
    <div class="text-xl font-bold mb-4 text-blue-600">OAE QR Genrate</div>
    <nav class="space-y-3">
      <a href="#qr" class="nav-link block px-3 py-2 rounded hover:bg-gray-200">QR Code Generator</a>
      <a href="#shorturl" class="nav-link block px-3 py-2 rounded hover:bg-gray-200">Short URL</a>
      <a href="#" class="block px-3 py-2 rounded hover:bg-gray-200">PDF Tools</a>
      <a href="#" class="block px-3 py-2 rounded hover:bg-gray-200">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-6 overflow-auto">
    
    <!-- QR Code Generator Section -->
    <section id="qr" class="content-section">
      <h1 class="text-2xl font-bold text-blue-700 mb-6">‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code (‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÑ‡∏î‡πâ)</h1>
      
      <div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto">
        <label class="block mb-2 font-semibold">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏£‡∏∑‡∏≠ URL:</label>
        <input id="qrText" type="text" class="w-full p-2 border rounded mb-4" placeholder="‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡∏´‡∏£‡∏∑‡∏≠ URL">

        <div class="grid grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block mb-1 font-semibold">‡∏Ç‡∏ô‡∏≤‡∏î:</label>
            <select id="qrSize" class="w-full p-2 border rounded">
              <option value="200">200 x 200</option>
              <option value="300" selected>300 x 300</option>
              <option value="400">400 x 400</option>
            </select>
          </div>
          <div>
            <label class="block mb-1 font-semibold">‡∏™‡∏µ‡∏à‡∏∏‡∏î (Foreground):</label>
            <input type="color" id="qrColor" value="#000000" class="w-full h-[38px] border rounded">
          </div>
        </div>

        <label class="block mb-1 font-semibold">‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡∏≠‡∏á QR:</label>
        <select id="qrStyle" class="w-full p-2 border rounded mb-4">
          <option value="square">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (Square)</option>
          <option value="dots">‡∏à‡∏∏‡∏î (Dots)</option>
          <option value="rounded">‡∏°‡∏∏‡∏°‡∏°‡∏ô (Rounded)</option>
          <option value="classy">‡∏™‡∏ß‡∏¢‡∏´‡∏£‡∏π (Classy)</option>
          <option value="classy-rounded">Classy + Rounded</option>
          <option value="extra-rounded">Extra Rounded</option>
        </select>

        <button onclick="generateQR()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">‡∏™‡∏£‡πâ‡∏≤‡∏á QR</button>

        <div id="qrContainer" class="mt-6 text-center"></div>
        <div class="text-center mt-4 hidden" id="downloadBtn">
          <button onclick="downloadQR()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
        </div>
      </div>
    </section>
	
    <!-- Short URL Section -->
    <section id="shorturl" class="content-section hidden">
      <h1 class="text-2xl font-bold text-blue-700 mb-6">‡∏¢‡πà‡∏≠ URL (Short URL)</h1>
      
      <div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto">
        <label class="block mb-2 font-semibold">‡∏Å‡∏£‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏¢‡∏≤‡∏ß (Long URL):</label>
        <input id="longUrl" type="text" class="w-full p-2 border rounded mb-4" placeholder="https://example.com/very/long/link">

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block mb-1 font-semibold">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏•‡∏¥‡∏á‡∏Å‡πå:</label>
            <select id="urlType" class="w-full p-2 border rounded">
              <option value="auto">‡∏™‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (Auto)</option>
              <option value="custom">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á</option>
              <option value="readable">‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢</option>
            </select>
          </div>
          <div id="customCodeDiv" class="hidden">
            <label class="block mb-1 font-semibold">‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£/‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç):</label>
            <input id="customCode" type="text" class="w-full p-2 border rounded" placeholder="mylink" maxlength="10">
          </div>
        </div>

        <button onclick="shortenURL()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô</button>

        <div id="shortResult" class="mt-4 text-center hidden">
          <p class="mb-2 font-semibold">‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:</p>
          <div class="bg-gray-50 p-3 rounded border">
            <input id="shortLink" class="p-2 border rounded w-full text-center text-blue-700 font-semibold bg-white mb-2" readonly>
            <div class="text-sm text-gray-600 mb-2">
              ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß: <span id="linkLength" class="font-semibold"></span> ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
            </div>
            <div class="flex gap-2 justify-center">
              <button onclick="copyShortLink()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
              <button onclick="testShortLink()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
              <button onclick="generateQRFromShort()" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">‡∏™‡∏£‡πâ‡∏≤‡∏á QR</button>
            </div>
          </div>
        </div>

        <!-- Ultra Short Links Section -->
        <div class="mt-6 p-4 bg-blue-50 rounded-lg">
          <h3 class="font-semibold text-blue-800 mb-2">üöÄ ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© (Ultra Short)</h3>
          <p class="text-sm text-gray-700 mb-3">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏™‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏û‡∏µ‡∏¢‡∏á 6-8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå</p>
          <button onclick="generateUltraShort()" class="bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</button>
        </div>
      </div>
    </section>

  </main>

  <script>
    let qr = null;

    // QR Code Functions
    function generateQR() {
      const text = document.getElementById("qrText").value.trim();
      const size = parseInt(document.getElementById("qrSize").value);
      const color = document.getElementById("qrColor").value;
      const style = document.getElementById("qrStyle").value;

      if (!text) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô");

      if (qr) {
        document.getElementById("qrContainer").innerHTML = "";
      }

      qr = new QRCodeStyling({
        width: size,
        height: size,
        data: text,
        dotsOptions: {
          color: color,
          type: style
        },
        backgroundOptions: {
          color: "#ffffff"
        },
        imageOptions: {
          crossOrigin: "anonymous",
          margin: 5
        }
      });

      qr.append(document.getElementById("qrContainer"));
      document.getElementById("downloadBtn").classList.remove("hidden");
    }

    function downloadQR() {
      if (qr) {
        qr.download({ name: "qr-code", extension: "png" });
      }
    }

    // Short URL Functions
    async function shortenURL() {
      const longUrl = document.getElementById("longUrl").value.trim();
      const urlType = document.getElementById("urlType").value;
      const customCode = document.getElementById("customCode").value.trim();
      const resultDiv = document.getElementById("shortResult");
      const shortLinkInput = document.getElementById("shortLink");
      const lengthSpan = document.getElementById("linkLength");
      const button = document.querySelector('button[onclick="shortenURL()"]');

      if (!longUrl) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Å‡πà‡∏≠‡∏ô");
        return;
      }

      if (!longUrl.startsWith("http://") && !longUrl.startsWith("https://")) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô https://example.com");
        return;
      }

      // Show loading state
      button.disabled = true;
      button.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á...";

      let shortLink = "";

      try {
        if (urlType === "custom" && customCode) {
          shortLink = await createCustomShortURL(longUrl, customCode);
        } else if (urlType === "readable") {
          shortLink = await createReadableShortURL(longUrl);
        } else {
          shortLink = await createAutoShortURL(longUrl);
        }

        shortLinkInput.value = shortLink;
        lengthSpan.textContent = shortLink.length;
        resultDiv.classList.remove("hidden");

      } catch (error) {
        console.error("Error:", error);
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error.message);
      }

      // Reset button state
      button.disabled = false;
      button.textContent = "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô";
    }

    async function createAutoShortURL(longUrl) {
      // Try ultra-short services first
      const ultraShortAPIs = [
        {
          name: "t.ly",
          url: `https://t.ly/api/v1/link/shorten`,
          method: "POST",
          body: JSON.stringify({ long_url: longUrl }),
          headers: { "Content-Type": "application/json" }
        }
      ];

      // If ultra-short fails, use regular APIs
      const regularAPIs = [
        {
          name: "TinyURL",
          url: `https://tinyurl.com/api-create.php?url=${encodeURIComponent(longUrl)}`,
          method: "GET",
          parser: (response) => response.text()
        },
        {
          name: "is.gd", 
          url: `https://is.gd/create.php?format=simple&url=${encodeURIComponent(longUrl)}`,
          method: "GET",
          parser: (response) => response.text()
        }
      ];

      // Try all APIs
      const allAPIs = [...ultraShortAPIs, ...regularAPIs];
      
      for (const api of allAPIs) {
        try {
          const response = await fetch(api.url, {
            method: api.method,
            headers: api.headers,
            body: api.body,
            mode: 'cors'
          });

          if (!response.ok) continue;

          let shortLink;
          if (api.parser) {
            shortLink = await api.parser(response);
          } else {
            const data = await response.json();
            shortLink = data.short_url || data.short_link;
          }

          if (shortLink && shortLink.startsWith('http')) {
            return shortLink;
          }
        } catch (error) {
          continue;
        }
      }

      // Fallback to custom ultra short
      return generateUltraShortFallback(longUrl);
    }

    async function createCustomShortURL(longUrl, customCode) {
      // Try TinyURL with custom alias
      try {
        const response = await fetch(`https://tinyurl.com/api-create.php?url=${encodeURIComponent(longUrl)}&alias=${customCode}`);
        const result = await response.text();
        if (result.startsWith('http')) {
          return result;
        }
      } catch (error) {
        // Fallback to simulated custom short URL
      }
      
      return `https://t.ly/${customCode}`;
    }

    async function createReadableShortURL(longUrl) {
      // Extract readable part from URL
      const url = new URL(longUrl);
      const pathParts = url.pathname.split('/').filter(p => p.length > 0);
      const readable = pathParts[pathParts.length - 1] || url.hostname.split('.')[0];
      const cleanReadable = readable.replace(/[^a-zA-Z0-9]/g, '').substring(0, 8);
      
      return `https://go.to/${cleanReadable}`;
    }

    function generateUltraShort() {
      const longUrl = document.getElementById("longUrl").value.trim();
      
      if (!longUrl) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Å‡πà‡∏≠‡∏ô");
        return;
      }

      if (!longUrl.startsWith("http://") && !longUrl.startsWith("https://")) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô https://example.com");
        return;
      }

      const ultraShort = generateUltraShortFallback(longUrl);
      document.getElementById("shortLink").value = ultraShort;
      document.getElementById("linkLength").textContent = ultraShort.length;
      document.getElementById("shortResult").classList.remove("hidden");
    }

    function generateUltraShortFallback(longUrl) {
      // Create ultra-short URLs (6-8 characters total)
      const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      const hash = btoa(longUrl).replace(/[^a-zA-Z0-9]/g, '');
      let short = '';
      
      for (let i = 0; i < 4; i++) {
        short += chars[hash.charCodeAt(i) % chars.length];
      }
      
      return `t.ly/${short}`; // Total: 8 characters including domain
    }

    function generateQRFromShort() {
      const shortLink = document.getElementById("shortLink").value;
      if (shortLink) {
        document.getElementById("qrText").value = shortLink;
        showSection("qr");
        generateQR();
      }
    }

    function copyShortLink() {
      const shortLinkInput = document.getElementById("shortLink");
      shortLinkInput.select();
      shortLinkInput.setSelectionRange(0, 99999);
      
      try {
        document.execCommand("copy");
        alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß!");
      } catch (err) {
        // Fallback for modern browsers
        navigator.clipboard.writeText(shortLinkInput.value).then(() => {
          alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß!");
        }).catch(() => {
          alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á");
        });
      }
    }

    function testShortLink() {
      const shortLink = document.getElementById("shortLink").value;
      if (shortLink) {
        window.open(shortLink, '_blank');
      }
    }

    // Navigation Functions
    function showSection(sectionId) {
      // Hide all sections
      document.querySelectorAll(".content-section").forEach(section => {
        section.classList.add("hidden");
      });
      
      // Show target section
      const targetSection = document.getElementById(sectionId);
      if (targetSection) {
        targetSection.classList.remove("hidden");
      }
      
      // Update navigation active state
      document.querySelectorAll(".nav-link").forEach(link => {
        link.classList.remove("bg-blue-100", "text-blue-700", "font-medium");
        link.classList.add("hover:bg-gray-200");
      });
      
      const activeLink = document.querySelector(`a[href="#${sectionId}"]`);
      if (activeLink) {
        activeLink.classList.add("bg-blue-100", "text-blue-700", "font-medium");
        activeLink.classList.remove("hover:bg-gray-200");
      }
    }

    // Event Listeners
    document.addEventListener("DOMContentLoaded", () => {
      // Handle navigation clicks
      document.querySelectorAll(".nav-link").forEach(link => {
        link.addEventListener("click", (e) => {
          e.preventDefault();
          const href = link.getAttribute("href");
          if (href.startsWith("#")) {
            const sectionId = href.substring(1);
            showSection(sectionId);
            window.location.hash = href;
          }
        });
      });

      // URL Type change handler
      document.getElementById("urlType").addEventListener("change", (e) => {
        const customDiv = document.getElementById("customCodeDiv");
        if (e.target.value === "custom") {
          customDiv.classList.remove("hidden");
        } else {
          customDiv.classList.add("hidden");
        }
      });

      // Handle initial hash
      const hash = window.location.hash;
      if (hash) {
        const sectionId = hash.substring(1);
        showSection(sectionId);
      } else {
        showSection("qr"); // Default to QR section
      }
    });

    // Handle hash changes
    window.addEventListener("hashchange", () => {
      const hash = window.location.hash;
      if (hash) {
        const sectionId = hash.substring(1);
        showSection(sectionId);
      }
    });

    // Enter key support for inputs
    document.getElementById("qrText").addEventListener("keypress", (e) => {
      if (e.key === "Enter") generateQR();
    });

    document.getElementById("longUrl").addEventListener("keypress", (e) => {
      if (e.key === "Enter") shortenURL();
    });
  </script>

</body>
</html>
